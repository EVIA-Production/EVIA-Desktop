appId: com.taylos.app
productName: Taylos

afterPack: ./scripts/afterPack.js
afterSign: ./scripts/notarize.js
# Custom URL scheme for deep linking (auth callback from web)
protocols:
  - name: Taylos
    schemes:
      - taylos
files:
  - dist/main/**
  - dist/renderer/**
  - src/main/assets/**
  - "!dist/win-unpacked/**"
  - "!dist/*.exe"
  - "!dist/*.dmg"
  - "!dist/*.zip"
  - "!dist/mac*/**"
asarUnpack:
  - "src/main/assets/SystemAudioDump"
  - "src/main/assets/WASAPILoopback.exe"
# ðŸ”§ Run afterPack script to sign SystemAudioDump with entitlements
mac:
  icon: src/main/assets/icon.png
  category: public.app-category.productivity
  hardenedRuntime: true
  notarize: false
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  gatekeeperAssess: false
  extendInfo:
    LSUIElement: false # Ensure app shows in Dock
    ElectronTeamID: ${APPLE_TEAM_ID} # Set via env var when signing
    NSMicrophoneUsageDescription: "Taylos needs access to your microphone to transcribe your voice in meetings."
    NSScreenCaptureUsageDescription: "Taylos needs access to screen recording to capture system audio from meetings and calls."
    NSCameraUsageDescription: "Taylos may need camera access for screen recording functionality."
  target:
    - target: dir
    - target: dmg
      arch:
        - x64
        - arm64
    - target: zip
      arch:
        - x64
        - arm64

win:
  target:
    - target: nsis
    - target: portable
  icon: build/icon.ico
  artifactName: "Taylos-${version}.${ext}"
  forceCodeSigning: false
  # Certum code signing â€” set WIN_CSC_LINK and WIN_CSC_KEY_PASSWORD env vars
  # certificateSubjectName: "Benedict Kroetz"  # Uncomment when Certum .p12 is extracted
  publisherName: "Benedict Kroetz"
  signAndEditExecutable: true

nsis:
  oneClick: false
  perMachine: false
  allowToChangeInstallationDirectory: true
  deleteAppDataOnUninstall: false

dmg:
  format: UDZO
  writeUpdateInfo: true
