appId: com.evia.app
productName: EVIA

afterPack: ./scripts/afterPack.js
# üîê Custom URL scheme for deep linking (auth callback from web)
protocols:
  - name: EVIA
    schemes:
      - evia
files:
  - dist/main/**
  - dist/renderer/**
  - src/main/assets/**
  - "!dist/win-unpacked/**"
  - "!dist/*.exe"
  - "!dist/*.dmg"
  - "!dist/*.zip"
  - "!dist/mac*/**"
asarUnpack:
  - "src/main/assets/SystemAudioDump"
  - "src/main/assets/WASAPILoopback.exe"
# üîß Run afterPack script to sign SystemAudioDump with entitlements
mac:
  icon: src/main/assets/icon.png
  category: public.app-category.productivity
  hardenedRuntime: true
  entitlements: build/entitlements.mac.plist
  entitlementsInherit: build/entitlements.mac.plist
  gatekeeperAssess: false
  extendInfo:
    LSUIElement: false # Ensure app shows in Dock
    ElectronTeamID: "not-set" # Use "not-set" for ad-hoc signing
    NSMicrophoneUsageDescription: "EVIA needs access to your microphone to transcribe your voice in meetings."
    NSScreenCaptureUsageDescription: "EVIA needs access to screen recording to capture system audio from meetings and calls."
    NSCameraUsageDescription: "EVIA may need camera access for screen recording functionality."
  target:
    - target: dir
    - target: dmg
      arch:
        - x64
        - arm64
    - target: zip
      arch:
        - x64
        - arm64

win:
  target:
    - target: dir
    - target: portable
  icon: build/icon.ico
  artifactName: "EVIA-${version}.${ext}"
  forceCodeSigning: false
  signAndEditExecutable: false  # Disabled for now due to symlink error on Windows

nsis:
  oneClick: false
  perMachine: false
  allowToChangeInstallationDirectory: true
  deleteAppDataOnUninstall: false

dmg:
  format: UDZO
  writeUpdateInfo: false
publish: null
